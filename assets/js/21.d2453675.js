(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{522:function(s,v,t){"use strict";t.r(v);var e=t(16),_=Object(e.a)({},(function(){var s=this,v=s.$createElement,t=s._self._c||v;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"zbestpc项目工程化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#zbestpc项目工程化"}},[s._v("#")]),s._v(" ZBestPC项目工程化")]),s._v(" "),t("h3",{attrs:{id:"准备工作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#准备工作"}},[s._v("#")]),s._v(" 准备工作")]),s._v(" "),t("p",[s._v("项目源码："),t("a",{attrs:{href:"https://github.com/NewCoder798/ZBestPC",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/NewCoder798/ZBestPC"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("源码分析：原生html + css + js项目")]),s._v(" "),t("p",[s._v("问题分析")]),s._v(" "),t("ol",[t("li",[s._v("css和js"),t("strong",[s._v("资源多")]),s._v("，全部采用"),t("strong",[s._v("同步加载")]),s._v("，渲染需要"),t("strong",[s._v("多次请求和加载")]),s._v("，降低页面"),t("strong",[s._v("加载性能")])]),s._v(" "),t("li",[s._v("css和js资源"),t("strong",[s._v("未压缩")])]),s._v(" "),t("li",[s._v("需同时维护html、css和js，代码逻辑和结构不清晰，"),t("strong",[s._v("迭代困难，难以维护")])]),s._v(" "),t("li",[s._v("项目不支持source-map,"),t("strong",[s._v("调试困难")])])]),s._v(" "),t("h3",{attrs:{id:"项目需求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#项目需求"}},[s._v("#")]),s._v(" 项目需求")]),s._v(" "),t("ol",[t("li",[s._v("第一阶段:项目 webpack 改造，使原生is项目能够支持模块开发及打包")]),s._v(" "),t("li",[s._v("第二阶段:Vue SPA (单页应用)改造，使项目能够使用 Vue 进行单页应用开发")]),s._v(" "),t("li",[s._v("第三阶段:Vue MPA (多页应用) 改造，使项目能够使用 Vue 进行多页应用开发")])]),s._v(" "),t("h3",{attrs:{id:"第一阶段-webpack改造"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第一阶段-webpack改造"}},[s._v("#")]),s._v(" 第一阶段：Webpack改造")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("项目初始化")]),s._v(" "),t("ol",[t("li",[s._v("创建npm项目")]),s._v(" "),t("li",[s._v("安装webpack依赖")]),s._v(" "),t("li",[s._v("创建js入口文件")]),s._v(" "),t("li",[s._v("创建webpack配置文件")]),s._v(" "),t("li",[s._v("配置package.json的build命令")]),s._v(" "),t("li",[s._v("执行npm run build打包")])])]),s._v(" "),t("li",[t("p",[s._v("首页移植")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("将资源文件html、js、css、img拷贝到src目录下")])]),s._v(" "),t("li",[t("p",[s._v("删除index.html中所有link和script的引用")])]),s._v(" "),t("li",[t("p",[s._v("安装html-webpack-plugin插件")]),s._v(" "),t("ul",[t("li",[s._v("html-webpack-plugin对于那些文件名中包含哈希值，并且"),t("strong",[s._v("哈希值会随着每次编译而改变")]),s._v("的webpack包特别有用。")]),s._v(" "),t("li",[s._v("此插件能够为html文件自动引入js")]),s._v(" "),t("li",[s._v("html-webpack-plugin模块安装指令如下：")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("npm install html"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("webpack"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("plugin "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("dev"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("save\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("使用"),t("strong",[s._v("style-loader")]),s._v("和"),t("strong",[s._v("css-loader")]),s._v("实现css资源的打包加载")])]),s._v(" "),t("li",[t("p",[s._v("使用"),t("strong",[s._v("ModuleAssets")]),s._v("解决图片url加载问题。（css和html中的url路径暂时是使用的源目录的路径。在项目优化中会使用copy-webpack-plugin进行解决）")])]),s._v(" "),t("li",[t("p",[s._v("使用"),t("strong",[s._v("ProvidePlugin")]),s._v("解决JQuery全局定义的问题")])])])]),s._v(" "),t("li",[t("p",[s._v("项目优化")]),s._v(" "),t("ul",[t("li",[s._v("分离js，不然所有的页面都在一个js中就太大了\n"),t("ol",[t("li",[s._v("使用HtmlWebpackPlugin中的chunks属性分配js文件")]),s._v(" "),t("li",[s._v("chunks中的名称对应entry中的键名")])])]),s._v(" "),t("li",[s._v("热部署，修改后不用频繁build\n"),t("ol",[t("li",[s._v("使用"),t("strong",[s._v("webpack-dev-server")])]),s._v(" "),t("li",[s._v("用完后图片资源会出现问题，我们需要使用插件进行资源的拷贝")])])]),s._v(" "),t("li",[s._v("使用"),t("strong",[s._v("mini-css-extract-plugin")]),s._v("对css进行分离")]),s._v(" "),t("li",[s._v("使用"),t("strong",[s._v("uglifyjs-webpack-plugin")]),s._v("对js进行压缩")]),s._v(" "),t("li",[s._v("使用"),t("strong",[s._v("css-minimizer-webpack-plugin")]),s._v("对js进行压缩")]),s._v(" "),t("li",[s._v("使用"),t("strong",[s._v("loadash")]),s._v(" 和"),t("strong",[s._v("treeshaking")]),s._v(" 使得代码中没被用到的部分不被打包，减少文件大小\n"),t("ul",[t("li",[s._v("treeshaking触发条件\n"),t("ol",[t("li",[s._v("通过解构的方式能够触发treeshaking")]),s._v(" "),t("li",[s._v("调用的npm包必须使用ESM")])])]),s._v(" "),t("li",[s._v("development模式下只能实现文件级的treeshaking，即打包当前方法所在的文件。"),t("strong",[s._v("在production模式下能实现方法级的treeshaking，即只打包当前方法。")])])])]),s._v(" "),t("li",[s._v("代码分割\n"),t("ul",[t("li",[s._v("使用webpack配置中的optimization下的"),t("strong",[s._v("splitChunks")])])])]),s._v(" "),t("li",[s._v("html代码分割\n"),t("ul",[t("li",[s._v("使用"),t("strong",[s._v("ejs")]),s._v("将网页中通用的部分提取出来，而不是复制粘贴")])])]),s._v(" "),t("li",[s._v("使用"),t("strong",[s._v("clean-webpack-plugin")]),s._v("清理dist中过时的文件，保证dist目录下的文件是最新的")])])])]),s._v(" "),t("h3",{attrs:{id:"第二阶段-vue-spa-vue-mpa应用改造"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第二阶段-vue-spa-vue-mpa应用改造"}},[s._v("#")]),s._v(" 第二阶段 Vue SPA / Vue MPA应用改造")]),s._v(" "),t("p",[s._v("创建build目录")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("将webpack.config.js文件放入build目录，并修改build指令如下")]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"build"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"webpack --config ./build/webpack.config.js"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("修改webpack.config.js下的资源目录，使得生成的dist目录与build同级")])]),s._v(" "),t("li",[t("p",[s._v("在build目录下，创建webpack.vue.config.js")])])]),s._v(" "),t("h3",{attrs:{id:"第三阶段-vue2升级vue3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第三阶段-vue2升级vue3"}},[s._v("#")]),s._v(" 第三阶段 Vue2升级Vue3")]),s._v(" "),t("p",[s._v("Vue3比起Vue2更偏向于使用解构的方式导入模块方法。如使用createApp()替代了需要导入Vue类进行实例化。")])])}),[],!1,null,null,null);v.default=_.exports}}]);